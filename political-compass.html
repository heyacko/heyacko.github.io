<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Modern U.S. Politics Compass ‚Äî Randomized Quiz</title>
<link rel="icon" type="image/png" href="favicon.png">
<link rel="stylesheet" href="style.css">
<style>
  /* 
  ================================================================================
  POLITICAL COMPASS QUIZ - PAGE-SPECIFIC STYLES
  ================================================================================
  This quiz measures political views on four axes:
  1. Collective vs Individual
  2. Institutional Trust vs Anti-Institutional  
  3. Cosmopolitan vs Localist
  4. Flux vs Order
  
  Most styling is handled by the shared stylesheet (style.css), but this page
  can have its own custom styles if needed for specific elements.
  
  CURRENT STATUS: All styles have been consolidated into the shared stylesheet
  for consistency across the site. This section is kept for future customizations.
  */
</style>
</head>
<body>
<div class="shared-wrap">
  <div class="shared-card">
    <h1 class="shared-h1">Modern U.S. Politics Compass</h1>
    <p class="shared-sub">
      Four axes: <span class="shared-pill">Collective ‚Üî Individual</span>
      <span class="shared-pill">Institutional Trust ‚Üî Anti-Institutional</span>
      <span class="shared-pill">Cosmopolitan ‚Üî Localist</span>
      <span class="shared-pill">Flux ‚Üî Order</span>
      <br><span class="shared-muted">Each visit samples 5 of 10 per axis (20 total) and shuffles the order.</span>
    </p>

    <!-- Progress -->
    <div class="shared-progress" role="progressbar" aria-valuemin="0" aria-valuemax="20" aria-valuenow="0">
      <span id="pbar"></span>
    </div>
    <div class="shared-meta"><span id="pcounter">Question 1 of 20</span></div>

    <!-- Question area -->
    <div id="stage" class="shared-qbox" aria-live="polite"></div>

    <!-- Controls -->
    <div class="shared-controls">
      <button id="backBtn" class="shared-btn-ghost" type="button" disabled>Back</button>
      <button id="nextBtn" class="shared-btn" type="button" disabled>Next</button>
      <button id="clearBtn" class="shared-btn-ghost" type="button">Restart</button>
      <a href="index.html" class="shared-btn-ghost">üè† Home</a>
    </div>

    <!-- Results -->
    <div id="results" class="shared-results">
      <h2>Your Results</h2>
      <p class="shared-muted">Scores range from ‚àí10 to +10 per axis (0 = neutral). Positive leans toward the left label; negative toward the right.</p>
      <div id="axisTable" class="shared-row" style="flex-direction:column;margin-top:12px;"></div>

      <h3 style="margin-top:22px;">Likely Cluster</h3>
      <p><strong id="clusterName"></strong></p>
      <p class="shared-muted" id="clusterDesc"></p>

      <div class="shared-footer">Directional, not definitive. Share with friends and compare.</div>
    </div>
  </div>
</div>

<script>
/* 
================================================================================
POLITICAL COMPASS QUIZ - MAIN CONFIGURATION
================================================================================
This quiz presents 20 questions (5 per axis) to measure political views on four dimensions.

SCORING SYSTEM:
- A = strongly toward LEFT label of the axis (+2 points)
- B = somewhat toward LEFT (+1 point)  
- C = somewhat toward RIGHT (-1 point)
- D = strongly toward RIGHT (-2 points)

FOUR AXES MEASURED:
1. Collective ‚Üî Individual (community vs personal responsibility)
2. Institutional Trust ‚Üî Anti-Institutional (trust in systems vs skepticism)
3. Cosmopolitan ‚Üî Localist (global vs local focus)
4. Flux ‚Üî Order (change vs stability)

Each visit randomly selects 5 questions per axis (20 total) and shuffles the order.
*/
const AXES = [
  { key:'collective', left:'Collective', right:'Individual' },
  { key:'trust',      left:'Institutional Trust', right:'Anti-Institutional' },
  { key:'cosmo',      left:'Cosmopolitan', right:'Localist' },
  { key:'flux',       left:'Flux', right:'Order' },
];

const BANK = {
  collective: [
    { text:'When someone falls on hard times, the primary responsibility lies with:',
      opts:['Society and community support systems','Both society and individual effort together','Individual effort with some community help','The individual to solve their own problems'] },
    { text:'The best way to reduce poverty is through:',
      opts:['Strong social safety nets and wealth redistribution','Mixed approach of safety nets and opportunity programs','Creating opportunities for individual success','Removing barriers so individuals can succeed on their own'] },
    { text:'Healthcare should be:',
      opts:['A universal right provided by society','A shared responsibility between society and individuals','Primarily individual responsibility with some public support','Entirely an individual responsibility and choice'] },
    { text:'When it comes to environmental protection:',
      opts:['Strong government regulation is essential','Government regulation combined with individual action','Market solutions with some government oversight','Individual choices and market forces work best'] },
    { text:'Education funding should come from:',
      opts:['Entirely from public/taxpayer sources','Mostly public with some private contribution','Mix of public and private funding','Primarily from private/individual sources'] },
    { text:'A town\'s bridge collapses. Who should rebuild it?',
      opts:['Government fully funds it','Town + company split cost','Local volunteers pitch in','Whoever needs it most pays'] },
    { text:'A company dumps trash in a river. What\'s fair?',
      opts:['Government fines & cleans','Public pressure/boycott','Locals organize cleanups','Market punishes them'] },
    { text:'Taxes are like:',
      opts:['Dues to a club I believe in','Rent for public services','A fee I put up with','Money taken even if I quit'] },
    { text:'During a pandemic, who should call the shots?',
      opts:['National experts','Local mayors','Doctors/clinics','Each person decides'] },
    { text:'Fairness at work means:',
      opts:['Everyone earning about the same','Everyone getting a fair shot','Keeping what you earn','No rules‚Äîjust hustle'] },
  ],
  trust: [
    { text:'When experts and government officials disagree with public opinion:',
      opts:['Trust the experts - they know better than the public','Consider expert opinion but also public concerns','Public opinion matters but experts provide valuable input','Trust public opinion - experts are often wrong or biased'] },
    { text:'The media\'s role should be:',
      opts:['To inform the public with trusted, professional reporting','To report facts while being transparent about perspectives','To present multiple viewpoints and let people decide','To challenge authority and question official narratives'] },
    { text:'When institutions make mistakes:',
      opts:['They should be reformed from within by trusted leaders','They need oversight and accountability measures','They should face consequences but the system works overall','They prove the system is broken and needs fundamental change'] },
    { text:'Scientific consensus should be:',
      opts:['Accepted as the best available knowledge','Respected but open to questioning and debate','Considered but not automatically trusted','Questioned until proven beyond doubt'] },
    { text:'Elections and democracy:',
      opts:['Work well and fairly represent the people','Work but could be improved with reforms','Have problems but are still the best system','Are broken and don\'t represent real public interests'] },
    { text:'News outlets are:',
      opts:['Mostly honest and trustworthy','Biased but necessary','Playing favorites','Rigging the game'] },
    { text:'Universities today are:',
      opts:['Labs making new tools','Old engines needing tune-ups','Echo chambers','Overpriced museums'] },
    { text:'Court rulings feel:',
      opts:['Like justice served','Usually fair but messy','Like insider decisions','Like theater pretending justice'] },
    { text:'Big Tech companies are:',
      opts:['Builders of the future','Too powerful but fixable','Corporate empires','Spy networks'] },
    { text:'If officials deny what you saw, you think:',
      opts:['I missed something','They are partly right','They are spinning it','They are lying'] },
    { text:'Public schools are:',
      opts:['Vital institutions','Fixable with reforms','Broken by bureaucracy','Vehicles for propaganda'] },
    { text:'"Fact-checkers" are:',
      opts:['Helpful referees','Helpful but biased','Narrative enforcers','Political censors'] },
  ],
  cosmo: [
    { text:'Immigration should be:',
      opts:['Welcomed broadly to enrich our culture','Managed to balance cultural diversity with integration','Limited to those who benefit our economy','Restricted to preserve our national identity'] },
    { text:'International trade:',
      opts:['Benefits everyone and should be maximized','Is good but needs some protection for domestic interests','Should be managed to protect local jobs and industries','Often hurts local workers and should be limited'] },
    { text:'Global problems require:',
      opts:['International cooperation and global solutions','Some international cooperation but national priorities first','National solutions with limited international coordination','Each nation solving their own problems independently'] },
    { text:'Cultural diversity:',
      opts:['Strengthens society and should be celebrated','Is valuable but we need shared common values','Is okay but our national culture should be primary','Threatens social cohesion and should be limited'] },
    { text:'Foreign aid should be:',
      opts:['Generous to help global development','Moderate and targeted to effective programs','Limited to strategic national interests','Minimal - we should focus on domestic issues'] },
    { text:'When new immigrants move in, you think:',
      opts:['Cool‚Äîmore food options','Hope they fit in fine','Hope things don\'t change much','Why can\'t we slow this down?'] },
    { text:'National pride feels:',
      opts:['Like pride in what we share globally','Like quiet appreciation','Like loyalty to roots','Like defending what\'s ours'] },
    { text:'Global trade is:',
      opts:['A rising tide lifting boats','A wave helping some, hurting others','Jobs shipped away','Giving up the steering wheel'] },
    { text:'If your kid wants to marry someone from a very different background, you feel:',
      opts:['Delighted','Curious but cautious','Uneasy','Strongly opposed'] },
    { text:'Local traditions vs global trends should:',
      opts:['Mix freely','Keep a balance','Protect old ways','Guard traditions fiercely'] },
  ],
  flux: [
    { text:'Social change should happen:',
      opts:['Quickly when society needs to evolve','Gradually to allow for adaptation','Carefully with consideration of consequences','Slowly to maintain stability and tradition'] },
    { text:'Traditional values are:',
      opts:['Often outdated and should be questioned','Some are valuable, others need updating','Provide important stability for society','Essential foundations that should be preserved'] },
    { text:'Technology and innovation should be:',
      opts:['Embraced rapidly for progress','Adopted with some oversight and regulation','Integrated carefully considering consequences','Adopted slowly to maintain social stability'] },
    { text:'Social norms should:',
      opts:['Evolve quickly to reflect changing values','Change gradually as society develops','Be updated carefully while maintaining structure','Remain stable to provide social order'] },
    { text:'Political reform should be:',
      opts:['Major and rapid to fix systemic problems','Significant but implemented incrementally','Adaptable but cautious about unintended consequences','Minimal - the system works well as is'] },
    { text:'Gender & family roles are:',
      opts:['Like apps‚Äîalways updating','Like tools‚Äîadjustable with limits','Like furniture‚Äîmove rarely','Like foundations‚Äîdon\'t change'] },
    { text:'Protests that block traffic are:',
      opts:['Vital to get attention','Okay if peaceful','Annoying but legal','Wrong, period'] },
    { text:'The best classroom looks like:',
      opts:['A playground of ideas','A lively debate hall','A disciplined workshop','A moral training ground'] },
    { text:'Tech change is:',
      opts:['Exciting','Good but needs brakes','Too fast','Dangerous'] },
    { text:'When a law feels wrong, you should:',
      opts:['Follow your conscience','Work to change it','Obey unless extreme','Always obey the law'] },
    { text:'Art that shocks people is:',
      opts:['Healthy for culture','Useful in small doses','Often attention-seeking','Corrosive to values'] },
    { text:'Dress codes at work should:',
      opts:['Let people express themselves','Be light guidelines','Require standard uniforms','Be strict rules'] },
    { text:'Drug policy should:',
      opts:['Legalize and regulate','Decriminalize most','Keep most illegal','Get tougher'] },
    { text:'Online speech rules should be:',
      opts:['As open as possible','Light moderation','Firm rules for safety','Strict to prevent chaos'] },
    { text:'City nightlife hours should be:',
      opts:['24/7‚Äîcities evolve','Late but limited','End earlier for peace','Close early‚Äîorder first'] },
  ],
};

const CHOICE_VALUE = { A:+2, B:+1, C:-1, D:-2 };

const CLUSTERS = [
  { name:'Liberal Institutionalist',
    match:s=>s.collective>0&&s.trust>0&&s.cosmo>0&&s.flux>0,
    desc:'Pro-government problem-solving, trusts major institutions, globalist identity, comfortable with cultural change.' },
  { name:'Progressive Populist',
    match:s=>s.collective>0&&s.trust<0&&s.cosmo>0&&s.flux>0,
    desc:'Collective action with low trust in elites; globalist identity; prefers fast change from outside institutions.' },
  { name:'National Conservative',
    match:s=>s.collective>=0&&s.trust<0&&s.cosmo<0&&s.flux<0,
    desc:'Community/government for cohesion, distrust of current elites, localist identity, order/tradition oriented.' },
  { name:'Traditional Conservative',
    match:s=>s.collective<0&&s.trust>0&&s.cosmo<0&&s.flux<0,
    desc:'Markets first, trusts legacy institutions, localist identity, values stability and hierarchy.' },
  { name:'Tech Libertarian',
    match:s=>s.collective<0&&s.trust<0&&s.cosmo>0&&s.flux>0,
    desc:'Individuals/markets over state, distrusts gatekeepers, globally oriented, change-friendly.' },
  { name:'Politically Homeless Pragmatist',
    match:s=>Math.abs(s.collective)<=2&&Math.abs(s.trust)<=2&&Math.abs(s.cosmo)<=2&&Math.abs(s.flux)<=2,
    desc:'Moderate across axes; case-by-case views; not easily pigeonholed.' },
];

/* ========= UTILS ========= */
function rngInt(n){ // 0..n-1 using crypto if available
  if (window.crypto?.getRandomValues){
    const a = new Uint32Array(1); crypto.getRandomValues(a);
    return a[0] % n;
  }
  return Math.floor(Math.random()*n);
}

function shuffle(arr){
  for (let i=arr.length-1;i>0;i--){
    const j = rngInt(i+1);
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function sampleN(arr, n){
  const idxs = arr.map((_,i)=>i);
  shuffle(idxs);
  return idxs.slice(0,n).map(i=>arr[i]);
}

/* ========= BUILD RANDOMIZED QUIZ (5 PER AXIS, SHUFFLED) ========= */
function buildQuiz(){
  const picked = [];
  for (const ax of AXES){
    const chosen = sampleN(BANK[ax.key], 5).map(q => ({...q, axis: ax.key}));
    picked.push(...chosen);
  }
  shuffle(picked);
  return picked; // length 20
}

/* ========= STATE / ELEMENTS ========= */
let QUESTIONS = buildQuiz();           // 20 randomized items
let idx = 0;                           // 0..19
const answers = new Array(QUESTIONS.length).fill(null); // 'A'|'B'|'C'|'D'|null

const stage = document.getElementById('stage');
const pbar = document.getElementById('pbar');
const pcounter = document.getElementById('pcounter');
const backBtn = document.getElementById('backBtn');
const nextBtn = document.getElementById('nextBtn');
const clearBtn = document.getElementById('clearBtn');
const resultsEl = document.getElementById('results');
const axisTable = document.getElementById('axisTable');
const clusterName = document.getElementById('clusterName');
const clusterDesc = document.getElementById('clusterDesc');

/* 
================================================================================
QUIZ RENDERING FUNCTION - DISPLAYS QUESTIONS AND PROGRESS
================================================================================
This function updates the quiz interface to show the current question, progress,
and answer options. It's called every time the user advances to a new question.
*/
function render() {
  const total = QUESTIONS.length;
  const human = idx+1;
  pbar.style.width = ((human-1)/total*100) + '%';
  document.querySelector('.shared-progress').setAttribute('aria-valuenow', human-1);
  pcounter.textContent = `Question ${human} of ${total}`;

  const q = QUESTIONS[idx];
  const axisObj = AXES.find(a=>a.key===q.axis);

  stage.innerHTML = '';
  const qtext = document.createElement('div');
  qtext.className = 'shared-qtext';
  qtext.textContent = `${human}. ${q.text}`;
  stage.appendChild(qtext);

  const opts = document.createElement('div'); opts.className='shared-opts';
  q.opts.forEach((opt, j) => {
    const letter = String.fromCharCode(65 + j); // A-D
    const id = `q${idx}_${letter}`;
    const lab = document.createElement('label');
    lab.className = 'shared-opt';
    lab.setAttribute('for', id);
    lab.innerHTML = `<input type="radio" name="q${idx}" id="${id}" value="${letter}"> <span>${letter}) ${opt}</span>`;
    opts.appendChild(lab);
  });
  stage.appendChild(opts);

  if (answers[idx]) {
    const input = stage.querySelector(`input[value="${answers[idx]}"]`);
    if (input) input.checked = true;
  }

  backBtn.disabled = idx === 0;
  nextBtn.textContent = (idx === total-1) ? 'See Results' : 'Next';
  nextBtn.disabled = !answers[idx];

  stage.addEventListener('change', (e) => {
    if (e.target && e.target.type === 'radio') {
      answers[idx] = e.target.value;
      nextBtn.disabled = false;
    }
  });

  resultsEl.style.display = 'none';
}
render();

/* ========= NAV ========= */
backBtn.addEventListener('click', () => {
  if (idx>0) { idx--; render(); }
});
nextBtn.addEventListener('click', () => {
  if (!answers[idx]) return;
  if (idx < QUESTIONS.length-1) {
    idx++; render();
  } else {
    showResults();
  }
});
clearBtn.addEventListener('click', () => {
  // restart with a fresh randomized test
  QUESTIONS = buildQuiz();
  for (let i=0;i<answers.length;i++) answers[i]=null;
  idx = 0;
  render();
});

/* ========= SCORING & RESULTS ========= */
function computeScores(){
  const scores = { collective:0, trust:0, cosmo:0, flux:0 };
  for (let i=0;i<QUESTIONS.length;i++){
    const a = answers[i];
    if (!a) continue;
    const val = CHOICE_VALUE[a];
    const axis = QUESTIONS[i].axis;
    scores[axis] += val;
  }
  return scores;
}
function pctFromScore(score){ return Math.max(0, Math.min(100, 50 + score*5)); }
function barColor(score){ if (score>=5) return 'var(--ok)'; if (score<=-5) return 'var(--bad)'; return 'var(--warn)'; }

function showResults(){
  const scores = computeScores();
  pbar.style.width = '100%';
  document.querySelector('.shared-progress').setAttribute('aria-valuenow', QUESTIONS.length);

  axisTable.innerHTML = '';
  AXES.forEach(ax => {
    const row = document.createElement('div'); row.className='shared-axis-row';
    const label = document.createElement('div');
    label.innerHTML = `<strong>${ax.left}</strong> <span class="muted">‚Üî</span> <strong>${ax.right}</strong>`;
    const bar = document.createElement('div'); bar.className='shared-bar';
    const span = document.createElement('span');
    span.style.width = pctFromScore(scores[ax.key]) + '%';
    span.style.background = barColor(scores[ax.key]);
    bar.appendChild(span);
    const val = document.createElement('div'); val.className='shared-muted';
    val.textContent = (scores[ax.key] >= 0 ? '+' : '') + scores[ax.key];
    row.appendChild(label); row.appendChild(bar); row.appendChild(val);
    axisTable.appendChild(row);
  });

  let chosen = CLUSTERS.find(c=>c.match(scores));
  if (!chosen){
    const bits = `${scores.collective>=0?'C':'I'}${scores.trust>=0?'T':'D'}${scores.cosmo>=0?'G':'L'}${scores.flux>=0?'F':'O'}`;
    chosen = { name:'Mixed Profile ('+bits+')', desc:'You mix positions across tribes. Read the axis scores; the nuance is the point.' };
  }
  clusterName.textContent = chosen.name;
  clusterDesc.textContent = chosen.desc;

  resultsEl.style.display = 'block';
  resultsEl.scrollIntoView({behavior:'smooth', block:'start'});
}

/* ========= QUALITY OF LIFE ========= */
document.addEventListener('keydown', (e)=>{
  if (e.key==='ArrowLeft' && !backBtn.disabled) backBtn.click();
  if (e.key==='ArrowRight' && !nextBtn.disabled) nextBtn.click();
});

/* ========= PARALLAX GRID EFFECT ========= */
window.addEventListener('scroll', function() {
  const scrolled = window.pageYOffset;
  document.documentElement.style.setProperty('--scroll-y', scrolled + 'px');
});
</script>
</body>
</html>
