<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>The Tuesday That Wouldn't End ‚Äî CYOA Worldview Quiz</title>
<link rel="stylesheet" href="style.css">
<style>
  /* Page-specific styles for rationalism-optimism.html */
  /* Most styles now consolidated in shared stylesheet */
</style>
</head>
<body>
<div class="shared-wrap">
  <div class="shared-card">
    <h1 class="shared-h1">The Tuesday That Wouldn't End</h1>
    <p class="shared-sub">A short, slightly absurd slice‚Äëof‚Äëlife adventure that quietly measures two axes: 
      <span class="shared-pill">Rationalism ‚Üî Romanticism</span>
      <span class="shared-pill">Optimism ‚Üî Pessimism</span>
    </p>

    <div class="shared-progress" role="progressbar" aria-valuemin="0" aria-valuemax="10" aria-valuenow="0">
      <span id="pbar"></span>
    </div>
    <div class="shared-meta"><span id="pcounter">Question 1 of 10</span><span id="flavor" class="shared-muted"></span></div>

    <div id="stage" class="shared-qbox" aria-live="polite"></div>

    <div class="shared-controls">
      <button id="backBtn" class="shared-btn-ghost" type="button" disabled>Back</button>
      <button id="nextBtn" class="shared-btn" type="button" disabled>Next</button>
      <button id="restartBtn" class="shared-btn-ghost" type="button">Restart</button>
      <a href="index.html" class="shared-btn-ghost">üè† Home</a>
    </div>

    <div id="results" class="shared-results">
      <h2>Your Archetype</h2>
      <p><span id="archetype" class="tag"></span></p>
      <p id="archDesc" class="shared-muted"></p>

      <h3 style="margin-top:18px;">Axis Scores</h3>
      <div id="axisTable" class="shared-grid" style="margin-top:8px;"></div>

      <div class="shared-footer">This is directional, not destiny. Share with friends and argue nicely.</div>
    </div>
  </div>
</div>

<script>
/* ===== Random garnish to keep each run a little different ===== */
const FLAVORS = [
  "Your alarm clock whispers statistics at you.",
  "The office ficus seems to be judging.",
  "A pigeon nods like it knows your secrets.",
  "Somewhere, a microwave beeps forever.",
  "You smell rain and also, unhelpfully, toast.",
  "The coffee machine says: ‚Äòbrbrbr optimism engaged‚Äô.",
  "A meeting invite reproduces by mitosis.",
  "Your shoelace unionizes mid‚Äëstride.",
  "A cloud looks exactly like your to‚Äëdo list.",
  "A calendar notification winks ominously."
];

function pickFlavor(){
  return FLAVORS[Math.floor(Math.random()*FLAVORS.length)];
}

/* ===== Questions (5 for Rationalism vs Romanticism; 5 for Optimism vs Pessimism) ===== */
// Each choice maps to axis deltas. We'll keep scoring simple and transparent.
// For Q1‚ÄìQ5 (Rationalism axis): A = +2 Rational, B = -1 Romantic, C = -2 Romantic, D = -2 Romantic (often fatalist/anti‚Äëmethod)
// For Q6‚ÄìQ10 (Optimism axis): A = +1 Optimism (calm, fix‚Äëit), B = +2 Optimism, C = +2 Optimism, D = -2 Pessimism

const QUESTIONS = [
  // 1‚Äì5 Rationalism vs Romanticism
  { id:1, text:"The Coffee Dilemma ‚Äî your mug has a crack.", opts:[
      {k:"A", t:"Glue it precisely and test it.", delta:{rat:+2}},
      {k:"B", t:"Try a TikTok ceramic hack.", delta:{rat:-1}},
      {k:"C", t:"Pour anyway. Character builds flavor.", delta:{rat:-2}},
      {k:"D", t:"Toss it; destiny hates mugs.", delta:{rat:-2}}
  ]},
  { id:2, text:"Commute ‚Äî your bike chain snaps.", opts:[
      {k:"A", t:"Diagnose and fix with a multitool.", delta:{rat:+2}},
      {k:"B", t:"Wait for a helpful stranger.", delta:{rat:-1}},
      {k:"C", t:"Walk and hum. It‚Äôs the journey.", delta:{rat:-2}},
      {k:"D", t:"Sit and curse entropy.", delta:{rat:-2}}
  ]},
  { id:3, text:"Meeting ‚Äî ‚Äòlet‚Äôs ideate outside the box‚Äô.", opts:[
      {k:"A", t:"Draw a workflow diagram.", delta:{rat:+2}},
      {k:"B", t:"Spin a soulful box metaphor.", delta:{rat:-1}},
      {k:"C", t:"Joke: ‚ÄòWhat if the box is sentient?‚Äô", delta:{rat:-2}},
      {k:"D", t:"Stare. The box has already won.", delta:{rat:-2}}
  ]},
  { id:4, text:"Lunch line ‚Äî they ran out of your order.", opts:[
      {k:"A", t:"Assemble an optimal substitute.", delta:{rat:+2}},
      {k:"B", t:"Ask the chef to improvise.", delta:{rat:-1}},
      {k:"C", t:"Pick the most chaotic special.", delta:{rat:-2}},
      {k:"D", t:"Leave. Nothing tastes right now.", delta:{rat:-2}}
  ]},
  { id:5, text:"Forecast ‚Äî rain starts mid‚Äëafternoon.", opts:[
      {k:"A", t:"Check Doppler and plan.", delta:{rat:+2}},
      {k:"B", t:"Smell the air; trust instincts.", delta:{rat:-1}},
      {k:"C", t:"Walk into it on purpose.", delta:{rat:-2}},
      {k:"D", t:"Mutter that nature is trolling.", delta:{rat:-2}}
  ]},

  // 6‚Äì10 Optimism vs Pessimism
  { id:6, text:"Elevator ‚Äî it shudders between floors.", opts:[
      {k:"A", t:"Press emergency, assess calmly.", delta:{opt:+1}},
      {k:"B", t:"Reassure everyone we‚Äôll be fine.", delta:{opt:+2}},
      {k:"C", t:"Start a sing‚Äëalong.", delta:{opt:+2}},
      {k:"D", t:"Whisper: ‚ÄòThis is how it ends.‚Äô", delta:{opt:-2}}
  ]},
  { id:7, text:"Neighborhood kid ‚Äî kite stuck on a power line.", opts:[
      {k:"A", t:"Calculate angles; fetch a pole.", delta:{opt:+1}},
      {k:"B", t:"Coach a wind‚Äëbelief speech.", delta:{opt:+2}},
      {k:"C", t:"Buy a new kite together.", delta:{opt:+2}},
      {k:"D", t:"Explain gravity always wins.", delta:{opt:-2}}
  ]},
  { id:8, text:"Friend text ‚Äî ‚ÄòI quit to travel.‚Äô", opts:[
      {k:"A", t:"Ask about their runway.", delta:{opt:+1}},
      {k:"B", t:"Say: ‚ÄòGo find yourself!‚Äô", delta:{opt:+2}},
      {k:"C", t:"Book a flight too.", delta:{opt:+2}},
      {k:"D", t:"‚ÄòWorld‚Äôs burning. Good luck.‚Äô", delta:{opt:-2}}
  ]},
  { id:9, text:"Street musician ‚Äî off‚Äëkey, earnest.", opts:[
      {k:"A", t:"Note the tuning; tip anyway.", delta:{opt:+1}},
      {k:"B", t:"Toss change ‚Äî heart counts.", delta:{opt:+2}},
      {k:"C", t:"Dance like the timeline isn‚Äôt real.", delta:{opt:+2}},
      {k:"D", t:"Mope: civilization in decline.", delta:{opt:-2}}
  ]},
  { id:10, text:"Sunset ‚Äî the sky is suspiciously green.", opts:[
      {k:"A", t:"Ponder atmospheric scattering.", delta:{opt:+1}},
      {k:"B", t:"Marvel at the magic of it.", delta:{opt:+2}},
      {k:"C", t:"Snap a photo; life is weird.", delta:{opt:+2}},
      {k:"D", t:"Assume pollution finally did it.", delta:{opt:-2}}
  ]}
];

/* ===== Shuffle questions lightly for variety (but keep axis blocks intact) ===== */
function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]] } return arr }
function buildRun(){
  const first = shuffle(QUESTIONS.slice(0,5));
  const second = shuffle(QUESTIONS.slice(5,10));
  return first.concat(second); // preserves axis grouping but randomizes within
}

let QUIZ = buildRun();
let idx = 0;
let answers = new Array(QUIZ.length).fill(null);
let score = { rat:0, opt:0 };

// Elements
const stage = document.getElementById('stage');
const pbar = document.getElementById('pbar');
const pcounter = document.getElementById('pcounter');
const flavor = document.getElementById('flavor');
const backBtn = document.getElementById('backBtn');
const nextBtn = document.getElementById('nextBtn');
const restartBtn = document.getElementById('restartBtn');
const resultsEl = document.getElementById('results');
const archetype = document.getElementById('archetype');
const archDesc = document.getElementById('archDesc');
const axisTable = document.getElementById('axisTable');

function render(){
  flavor.textContent = pickFlavor();
  const total = QUIZ.length; const human = idx+1;
  pbar.style.width = ((human-1)/total*100)+"%";
  document.querySelector('.shared-progress').setAttribute('aria-valuenow', human-1);
  pcounter.textContent = `Question ${human} of ${total}`;

  const q = QUIZ[idx];
  stage.innerHTML = '';
  const qtext = document.createElement('div'); qtext.className='shared-qtext'; qtext.textContent = `${human}. ${q.text}`; stage.appendChild(qtext);
  const opts = document.createElement('div'); opts.className='shared-opts';
  q.opts.forEach((opt, j)=>{
    const id = `q${idx}_${opt.k}`;
    const lab = document.createElement('label'); lab.className='shared-opt'; lab.setAttribute('for', id);
    lab.innerHTML = `<input type="radio" name="q${idx}" id="${id}" value="${opt.k}"> <span>${opt.k}) ${opt.t}</span>`;
    opts.appendChild(lab);
  });
  stage.appendChild(opts);

  // restore saved
  if (answers[idx]){
    const input = stage.querySelector(`input[value="${answers[idx]}"]`);
    if (input) input.checked = true;
  }

  backBtn.disabled = idx===0;
  nextBtn.textContent = (idx===total-1)?'See Results':'Next';
  nextBtn.disabled = !answers[idx];

  stage.addEventListener('change', (e)=>{
    if (e.target && e.target.type==='radio'){
      answers[idx] = e.target.value;
      nextBtn.disabled = false;
    }
  });

  resultsEl.style.display='none';
}

function computeScores(){
  score = { rat:0, opt:0 };
  for (let i=0;i<QUIZ.length;i++){
    const a = answers[i]; if(!a) continue;
    const q = QUIZ[i];
    const opt = q.opts.find(o=>o.k===a);
    if (opt?.delta?.rat) score.rat += opt.delta.rat;
    if (opt?.delta?.opt) score.opt += opt.delta.opt;
  }
  return score;
}

function pctFromScore(s, max){ // map ‚àí10..+10 => 0..100
  const clamped = Math.max(-max, Math.min(max, s));
  return 50 + (clamped / max) * 50;
}

function showResults(){
  computeScores();
  pbar.style.width = '100%';
  document.querySelector('.shared-progress').setAttribute('aria-valuenow', QUIZ.length);

  // Determine archetype
  const r = score.rat; const o = score.opt;
  let name, desc;
  if (r>=0 && o>=0){
    name = 'Engineer of Wonder (Rational + Optimist)';
    desc = 'Problems are puzzles, not tragedies. You trust methods and momentum. You will graph the sunset and then enjoy it.';
  } else if (r>=0 && o<0){
    name = 'Tragic Analyst (Rational + Pessimist)';
    desc = 'You measure everything and assume the universe forgot the warranty. Still, your diagnostics keep the ship afloat.';
  } else if (r<0 && o>=0){
    name = 'Dreaming Humanist (Romantic + Optimist)';
    desc = 'Vibes, stories, and small kindnesses fuel you. Chaos is raw material; hope is a craft you practice daily.';
  } else {
    name = 'Melancholic Poet (Romantic + Pessimist)';
    desc = 'You feel beauty most at the fault lines. You carry rainy-day metaphors in a pocket notebook and you‚Äôre not wrong.';
  }

  archetype.textContent = name;
  archDesc.textContent = desc;

  // Axis bars
  axisTable.innerHTML='';
  const rows = [
    {label:'Rationalism ‚Üî Romanticism', val: score.rat, max: 10},
    {label:'Optimism ‚Üî Pessimism', val: score.opt, max: 10}
  ];
  rows.forEach(row=>{
    const wrap = document.createElement('div'); wrap.className='shared-axis-row';
    const l = document.createElement('div'); l.innerHTML = `<strong>${row.label}</strong>`;
    const bar = document.createElement('div'); bar.className='shared-bar';
    const span = document.createElement('span'); span.style.width = pctFromScore(row.val,row.max)+'%';
    span.style.background = row.val>=0 ? 'var(--ok)' : 'var(--bad)';
    bar.appendChild(span);
    const v = document.createElement('div'); v.className='shared-muted'; v.textContent = (row.val>=0?'+':'')+row.val;
    wrap.appendChild(l); wrap.appendChild(bar); wrap.appendChild(v);
    axisTable.appendChild(wrap);
  });

  resultsEl.style.display='block';
  resultsEl.scrollIntoView({behavior:'smooth', block:'start'});
}

// Events
function next(){
  if (!answers[idx]) return;
  if (idx < QUIZ.length-1){ idx++; render(); }
  else { showResults(); }
}
function back(){ if (idx>0){ idx--; render(); } }
function restart(){ QUIZ = buildRun(); answers = new Array(QUIZ.length).fill(null); idx=0; score={rat:0,opt:0}; render(); }

backBtn.addEventListener('click', back);
nextBtn.addEventListener('click', next);
restartBtn.addEventListener('click', restart);

// Keyboard navigation
document.addEventListener('keydown',(e)=>{
  if (e.key==='ArrowLeft' && !backBtn.disabled) back();
  if (e.key==='ArrowRight' && !nextBtn.disabled) next();
});

// Init
render();
</script>
</body>
</html>
